var MY_UTILS=function(e){function t(e){try{return e=JSON.parse(e)}catch(t){return e}}var n={$document:e(document),$window:e(window),$body:e("body"),$scrollRoot:e("html, body"),$functionElems:null,$targetElems:null,selectors:{functionElement:"[data-fn]",targetElement:"[data-tg]"},attributes:{target:"data-fn-target",options:"data-fn-options"},classes:{open:"show",animating:"animating",animatingIn:"animating-in",animatingOut:"animating-out"},mediaSize:null,mediaSizes:[{breakpoint:0,label:"xs"},{breakpoint:576,label:"sm"},{breakpoint:768,label:"md"},{breakpoint:992,label:"lg"},{breakpoint:1200,label:"xl"}],anchorOffsetTop:0},a=e(n.selectors.functionElement+", "+n.selectors.targetElement);n.$functionElems=a.filter(n.selectors.functionElement),n.$targetElems=a.filter(n.selectors.targetElement);var o=n.$functionElems.filter('[data-fn="anchor-offset-elem"]');e.fn._getAnchorOffset=function(){return(o.length>0?this.outerHeight():0)+20},n.anchorOffsetTop=o._getAnchorOffset(),n.$window.on("sizeChange",function(){n.anchorOffsetTop=o._getAnchorOffset()}),e.fn.getTransitionDuration=function(){var e=0,t="transition-duration",n=["webkit","ms","moz","o"];if(this.css(t))e=this.css(t);else for(i=0;i<n.length;i++)if(this.css("-"+n[i]+"-"+t)){e=this.css("-"+n[i]+"-"+t);break}return e.indexOf("ms")>-1?parseFloat(e):1e3*parseFloat(e)},e.fn.setRemoveAnimationClass=function(t){t||n.classes.animating;var a=e(this),i=a.getTransitionDuration();if(i>0){a.addClass(t);setTimeout(function(){a.removeClass(t)},i)}},e.fn.elemPositionedInside=function(t){var n=e(this),a=e(t),i=n.offset().left,o=n.offset().top,s=n.width(),r=n.height(),l=a.offset().left,d=a.offset().top,c=a.outerWidth(),f=a.outerHeight();return i>=l&&i+s<=l+c&&o>=d&&o+r<=d+f},e.fn.ariaExpanded=function(n){return void 0!==n?(e(this).attr("aria-expanded",n),n):t(e(this).attr("aria-expanded"))},e.fn.aria=function(n,a){return void 0!==a?(e(this).attr("aria-"+n,a),a):t(e(this).attr("aria-"+n))};return _getmediaSize=function(){var e;if(window.matchMedia)for(i=0;i<n.mediaSizes.length-1;i++){if(window.matchMedia("(max-width: "+(n.mediaSizes[i+1].breakpoint-1)+"px)").matches){e=n.mediaSizes[i].label;break}e=n.mediaSizes[n.mediaSizes.length-1].label}else for(i=0;i<n.mediaSizes.length-1;i++){if(n.$window.width()<n.mediaSizes[i+1].breakpoint){e=n.mediaSizes[i].label;break}e=n.mediaSizes[n.mediaSizes.length-1].label}e!=n.mediaSize&&(n.$body.removeClass("media-"+n.mediaSize),n.$body.addClass("media-"+e),n.mediaSize=e,n.$window.trigger("sizeChange"))},n.$document.ready(function(){_getmediaSize(),n.$window.trigger("sizeChangeReady")}),n.$window.on("resize",function(){_getmediaSize()}),e.fn.getOptionsFromAttr=function(){var t=e(this).attr(n.attributes.options);return void 0!==t&&new Function("return "+t)()},n}(jQuery);!function(){var e=/iPad|iPhone|iPod/.test(navigator.platform)&&!window.MSStream,t=/(android)/i.test(navigator.userAgent);e?document.body.className+=" is-ios":t&&(document.body.className+=" is-android");var n=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var a=e.indexOf("Edge/");return a>0&&parseInt(e.substring(a+5,e.indexOf(".",a)),10)}();if(!1!==n&&n>9)for(document.body.className+=" ie ie"+n,i=n;i<=14;i++)document.body.className+=" ielte"+i;if(e){var a=document.body.children;for(i=0;i<a.length;i++)"DIV"==a[i].tagName&&a[i].setAttribute("onclick","void(0);")}}(),function(e,t){e.fn.animatedAnchors=function(n){var a=e(this);if(n=e.extend({},{scrollToInitialHash:!0,scrollDurationMin:300,scrollDurationMax:800,scrollDurationPer1000:400,offset:function(){return 0},scrollTolerance:1,fixedClass:"fixed"},n),e.fn._animatedScrollTo=function(){$this=e(this);var a=t.$window.scrollTop(),i=$this.offset().top+n.scrollTolerance,o=Math.abs(i-n.offset()-a)*n.scrollDurationPer1000/1e3;o<n.scrollDurationMin?o=n.scrollDurationMin:o>n.scrollDurationMax&&(o=n.scrollDurationMax),t.$scrollRoot.animate({scrollTop:i-n.offset()},o)},n.scrollToInitialHash){var i=e(window.location.hash);window.location.hash&&i.length>0&&(i._animatedScrollTo(),t.$window.on("load",function(){i._animatedScrollTo()}))}a.each(function(){var t=e(this);t.on("click",function(){var n=t.attr("href"),a=e(n);a.length>0&&a._animatedScrollTo()})})}}(jQuery,MY_UTILS),function(e,t){e.fn.checkSlideToggle=function(n){var a={effectIn:"slideDown",effectOut:"slideUp",effectDuration:400,triggerSelector:'input[type="checkbox"]',openedClass:t.classes.open,animatingClass:t.classes.animating,animatingInClass:t.classes.animatingIn,animatingOutClass:t.classes.animatingOut};n=e.extend({},a,n);e(this).each(function(){var t=e(this),a=t.find(n.triggerSelector),i=t.find(e(a.attr("aria-controls")));a.is(":checked")?(t.addClass(n.openedClass),a.ariaExpanded(!0),i.show()):(t.removeClass(n.openedClass),a.ariaExpanded(!1),i.hide()),a.on("change",function(){a.ariaExpanded()?(t.addClass(n.animatingClass).addClass(n.animatingOutClass).removeClass(n.openedClass),a.ariaExpanded(!1),i.stop()[n.effectOut](n.effectDuration,function(){t.removeClass(n.animatingClass).removeClass(n.animatingOutClass)})):(t.addClass(n.animatingClass).addClass(n.animatingInClass),a.ariaExpanded(!0),i.stop()[n.effectIn](n.effectDuration,function(){t.addClass(n.openedClass).removeClass(n.animatingClass).removeClass(n.animatingInClass)}))})})}}(jQuery,MY_UTILS),function(e,t){var n,a={Vorstand:[{name:"Vorsitzende",count:2},{name:"Schatzmeister*in",count:1},{name:"weitere Mitglieder",count:"variable",countVariable:!0,overall:!0}],Schiedsgericht:[{name:"Richter*innen",count:3},{name:"Ersatzrichter*innen",count:2,overall:!0}],"Kassenprüfer*innen":[{name:"Kassenprüfer*innen",count:2}]},i=new URL(document.location.href).searchParams.get("preset");2==i?n={Vorstand:[{name:"Vorsitzende",count:2,joint:!0,candidates:[{candidate:{name:"Lina Limone",female:!0,diverse:!1},yes:18,no:2},{candidate:{name:"Manfred Mango",female:!1,diverse:!1},yes:12,no:1},{candidate:{name:"Olivia Orange",female:!0,diverse:!0},yes:12,no:0}]},{name:"Schatzmeister*in",count:1,candidates:[{candidate:{name:"Anna Ananas",female:!0,diverse:!0},yes:12,no:4},{candidate:{name:"Cora Cocos",female:!0,diverse:!1},yes:7,no:1}]},{name:"weitere Mitglieder",count:3,countVariable:!0,overall:!0,joint:!1,candidates:[[{candidate:{name:"Maria Maracuja",female:!0,diverse:!0},yes:12,no:0},{candidate:{name:"Bernard Banane",female:!1,diverse:!1},yes:12,no:1}],[{candidate:{name:"Kira Kirsch-Banane",female:!0,diverse:!1},yes:18,no:2},{candidate:{name:"Alfred Apfel",female:!1,diverse:!0},yes:11,no:3},{candidate:{name:"Anna Ananas",female:!0,diverse:!0},yes:12,no:4},{candidate:{name:"Cora Cocos",female:!0,diverse:!1},yes:7,no:1}],[{candidate:{name:"Kilian Kiwi",female:!1,diverse:!0},yes:7,no:0},{candidate:{name:"Mandy Mandarine",female:!0,diverse:!0},yes:8,no:2},{candidate:{name:"Melly Melone",female:!0,diverse:!1},yes:15,no:3}]]}]}:1==i&&(n={Vorstand:[{name:"Vorsitzende",count:2,joint:!0,candidates:[{candidate:{name:"Lina Limone",female:!0,diverse:!1},yes:18,no:2},{candidate:{name:"Manfred Mango",female:!1,diverse:!1},yes:12,no:1},{candidate:{name:"Olivia Orange",female:!0,diverse:!0},yes:12,no:0}],results:[{candidate:{name:"Lina Limone",female:!0,diverse:!1}},{candidate:{name:"Manfred Mango",female:!1,diverse:!1}}]},{name:"Schatzmeister*in",count:1,candidates:[{candidate:{name:"Kilian Kiwi",female:!1,diverse:!0},yes:7,no:0},{candidate:{name:"Mandy Mandarine",female:!0,diverse:!0},yes:8,no:2},{candidate:{name:"Melly Melone",female:!0,diverse:!1},yes:15,no:3}],results:[{candidate:{name:"Melly Melone",female:!0,diverse:!1}}]},{name:"weitere Mitglieder",count:3,countVariable:!0,overall:!0,joint:!0,candidates:[{candidate:{name:"Maria Maracuja",female:!0,diverse:!0},yes:12,no:0},{candidate:{name:"Bernard Banane",female:!1,diverse:!1},yes:12,no:1},{candidate:{name:"Kira Kirsch-Banane",female:!0,diverse:!1},yes:18,no:2},{candidate:{name:"Alfred Apfel",female:!1,diverse:!0},yes:11,no:3},{candidate:{name:"Anna Ananas",female:!0,diverse:!0},yes:12,no:4},{candidate:{name:"Cora Cocos",female:!0,diverse:!1},yes:7,no:1}]}],Schiedsgericht:[{name:"Richter*innen",count:3,joint:!0,candidates:[{candidate:{name:"Pablo Papaya",female:!1,diverse:!0},yes:8,no:0},{candidate:{name:"Lydia Litschi",female:!1,diverse:!1},yes:5,no:1},{candidate:{name:"Eduard Erdbeere",female:!0,diverse:!0},yes:7,no:0}]},{name:"Ersatzrichter*innen",count:2,joint:!0,overall:!0,candidates:[{candidate:{name:"Holly Holunder",female:!0,diverse:!1},yes:15,no:1},{candidate:{name:"Hila Himbeere",female:!0,diverse:!0},yes:9,no:0}]}]});var o=void 0!==n?e.extend({},a,n):e.extend({},a),s='[data-tg="election-step-',r='[data-fn="election-step-form-',l='[data-fn="election-step-select-',d='[data-tg="election-item-template-',c='[data-tg="election-item-append-',f="data-g-tg",u="election-item",m="data-item-id",v='[data-tg="election-subitem-template-',g='[data-g-tg="election-subitem-append-',p="data-g-tg",h="election-subitem",_="data-subitem-id",b="data-confirm-delete",S=[],C=[],y="name";S[0]={check:{selector:'[id^="election-check-"]',value:"true",name:"election_"}},C[0]={count:{selector:'[id^="election-count-"]',value:"",name:"count_"},joint:{selector:'[id^="election-joint-"]',value:"true",name:"joint_",saveAs:"joint"}},C[1]={name:{selector:'[id^="name-"]',value:"",name:"name_",confirmSubitemDelete:!0,saveAs:"name"},female:{selector:'[id^="female-check-"]',value:"true",name:"female_",saveAs:"female"},diverse:{selector:'[id^="diverse-check-"]',value:"true",name:"diverse_",saveAs:"diverse"}},C[2]={yes:{selector:'[id^="votes-yes-"]',value:"",name:"yes_",saveAs:"yes"},no:{selector:'[id^="votes-no-"]',value:"",name:"no_",saveAs:"no"}};var E='<option value="-1" selected>Alle</option>';e.fn._replaceTemplatePlaceholders=function(t){for(var n=e(this),a=0;a<t.length;a++){var i="{{ "+t[a][0]+" }}",o=new RegExp(i,"g");n.html(n.html().replace(o,t[a][1]))}return n},_checkElectionConfigCandidatesOrVotes=function(e,t,n){var a=Object.keys(o)[e];if(!a||void 0===t)return!1;console.log("key: "+a+" – i: "+t+" – j: "+n);_validCandidatesOrVotes=function(e){var t=!1,n=!1;if(void 0!==e){for(var a=0;a<e.length;a++)void 0===e[a].candidate&&(t=!0),void 0!==e[a].yes&&void 0!==e[a].no||(n=!0);return[!t,!n]}return[!1,!1]};var i;void 0!==o[a]&&void 0!==o[a][t]&&void 0!==o[a][t].candidates&&o[a][t].candidates.length>0&&(void 0===n?void 0!==o[a][t].candidates[0]&&(i=o[a][t].candidates):void 0!==o[a][t].candidates[n]&&o[a][t].candidates[n].length>0&&(i=o[a][t].candidates[n]));var s=_validCandidatesOrVotes(i);return[s[0],s[1]]};_validateItems=function(){console.log("_validateItems()");for(var e in o){Object.keys(o).indexOf(e);for(var t=0;t<o[e].length;t++)if(void 0!==o[e]&&void 0!==o[e][t]&&void 0!==o[e][t].candidates&&void 0!==o[e][t].candidates[0])if(void 0!==o[e][t].candidates[0].candidate)console.log("joint, has candidate");else if(void 0!==o[e][t].candidates[0][0]&&void 0!==o[e][t].candidates[0][0].candidate)for(var n=0;n<o[e][t].candidates.length;n++)console.log("single"),void 0!==o[e][t].candidates[n][0]&&void 0!==o[e][t].candidates[n][0].candidate?console.log(n+" has candidate"):console.log(n+" has no candidate");else console.log("has no candidates 2");else console.log("has no candidates 1")}},e.fn._addSublistItems=function(n,a,i,o,s){var r=n||1,l=void 0!==o&&s?s[o]:s,d=e(this),c=t.$targetElems.filter(v+1+'"]'),f=d.find(g+1+'"]'),u=d.find("["+_+"]").last(),S=0;u.length>0&&(S=parseInt(u.attr(_))+1);for(var E=0;E<r;E++){var $=S+E,x=c.clone();x._replaceTemplatePlaceholders([["index",$]]).removeAttr("style data-tg").attr(p,h).attr(_,$).show().find('[data-g-fn="election-subitem-remove"]').on("click",function(t){t.preventDefault();var n=e(this).closest("["+p+'="'+h+'"]'),a=n.find("input["+b+"]");if(a.length>0){var i=!1;a.each(function(){""!=(k=e(this)).val()&&(i=!0,k.addClass("is-invalid").on("focus",function(){e(this).removeClass("is-invalid")}))}),i||n.remove()}else n.remove()});for(var w in C[1]){var k=x.find(C[1][w].selector),T=d.attr(m);k.length>0&&(k.attr(y,C[1][w].name+T+"_"+$).attr("value",C[1][w].value),C[1][w].confirmSubitemDelete&&k.attr(b,""))}for(var w in C[2]){k=x.find(C[2][w].selector),T=d.attr(m);k.length>0&&(k.attr(y,C[2][w].name+T+"_"+$).attr("value",C[2][w].value),C[2][w].confirmSubitemDelete&&k.attr(b,""))}l&&l[E]&&l[E].candidate&&(l[E].candidate.name&&""!=l[E].candidate.name&&x.find('input[name^="name"]').val(l[E].candidate.name),l[E].candidate.female&&x.find('input[name^="female"]').attr("checked",""),l[E].candidate.diverse&&x.find('input[name^="diverse"]').attr("checked",""),void 0!==l[0].yes&&x.find('input[name^="yes"]').val(l[E].yes),void 0!==l[0].no&&x.find('input[name^="no"]').val(l[E].no)),x.appendTo(f)}},e.fn._validateNumberInput=function(){var t=e(this),n=t.find('[data-g-fn="validate"]');if(n.length>0){var a=t.find(n.attr("data-g-tg"));n.on("change keyup",function(){var t=e(this),n=parseInt(t.attr("min")),i=parseInt(t.attr("max")),o=t.val();console.log("min: "+n+" – max: "+i),"NaN"==typeof n&&"NaN"==typeof man||""==o||("NaN"!=typeof n&&o<n?t.val(n):"NaN"!=typeof man&&o>i&&t.val(i)),a.length>0&&(o>1?a.show():a.hide())})}},e.fn._getFormValues=function(t){var n=e(this),a={},i=t||"name";return n.find("input["+i+"], select["+i+"], textarea["+i+"]").each(function(t,n){var o=e(n);"radio"==o.attr("type")?o.is(":checked")&&(a[o.attr(i)]=o.val()):"checkbox"==o.attr("type")?a[o.attr(i)]=o.is(":checked")?o.val():null:a[o.attr(i)]=o.val()}),a},_filterMatchingIndexes=function(e,t){for(var n=[],a=0;a<e.length;a++)0===e[a].indexOf(t)&&n.push(e[a]);return n},_calculateElectionResult=function(e){return"string"==typeof e.current?[{candidate:{name:"Kira Kirsch-Banane",female:!0,diverse:!1}},{candidate:{name:"Alfred Apfel",female:!1,diverse:!0}}]:[{candidate:{name:"Lina Limone",female:!0,diverse:!1}}]},_getElectionResult=function(){for(var e in o){for(var t={structure:[],current:"",previous:[],candidates:[]},n=["name","count","joint","overall"],a=0;a<o[e].length;a++){t.structure.push({});for(var i=0;i<n.length;i++)void 0!==o[e][a][n[i]]&&(t.structure[a][n[i]]=o[e][a][n[i]])}for(a=0;a<o[e].length;a++){_setPrevious=function(){if(0===a)t.previous=[];else{var n=a-1;if(void 0!==o[e][n].results&&o[e][n].results.length>0)for(var i=0;i<o[e][n].results.length;i++)t.previous.push(o[e][n].results[i])}};var s=!1,r=!1;if(void 0!==o[e][a]&&void 0!==o[e][a].candidates&&o[e][a].candidates.length>0&&void 0!==o[e][a].candidates[0].candidate){for(i=0;i<o[e][a].candidates.length;i++)void 0!==o[e][a].candidates[i].yes&&void 0!==o[e][a].candidates[i].no?s=!0:r=!0;if(s&&!r){t.current=o[e][a].name,_setPrevious(),t.candidates=o[e][a].candidates;(d=_calculateElectionResult(t))&&(o[e][a].results=d)}}else if(void 0!==o[e][a]&&void 0!==o[e][a].candidates&&o[e][a].candidates.length>0&&void 0===o[e][a].candidates[0].candidate&&o[e][a].candidates[0].length>0&&void 0!==o[e][a].candidates[0][0].candidate){_setPrevious();for(var l=0;l<o[e][a].candidates.length;l++){for(i=0;i<o[e][a].candidates[l].length;i++)void 0!==o[e][a].candidates[l][i].yes&&void 0!==o[e][a].candidates[l][i].no?s=!0:r=!0;if(s&&!r){t.current=[o[e][a].name,l],0===l&&(o[e][a].results=[]),t.candidates=o[e][a].candidates[l];var d;(d=_calculateElectionResult(t))&&(o[e][a].results.push(d[0]),t.previous.push(d[0]))}}}}}return!!d},e.fn._getElectionCurrentConfig_0=function(){o=void 0!==n?e.extend({},a,n):e.extend({},a);var t=e(this)._getFormValues(y),i=[];for(var s in o){var r=Object.keys(o).indexOf(s);if(null===t[S[0].check.name+r])i.push(s);else for(var l=0;l<o[s].length;l++){var d=t[C[0].count.name+r+"_"+l];d&&(d=parseInt(d));var c=t[C[0].joint.name+r+"_"+l];c&&(c=JSON.parse(c)),null!=d?o[s][l].count=d:d=o[s][l].count,null!=c?o[s][l].joint=!0:d>1&&(o[s][l].joint=!1),d>1&&!c?void 0!==o[s][l].candidates&&void 0!==o[s][l].candidates[0]&&void 0!==o[s][l].candidates[0].candidate&&delete o[s][l].candidates:void 0!==o[s][l].candidates&&void 0!==o[s][l].candidates[0]&&void 0!==o[s][l].candidates[0][0]&&void 0!==o[s][l].candidates[0][0].candidate&&delete o[s][l].candidates}}for(var f=0;f<i.length;f++)delete o[i[f]]},e.fn._getElectionCurrentConfig_1=function(){var t=e(this);_isValidCandidate=function(e){return void 0!==n[e]&&null!==n[e]&&""!==n[e]},_getCandidate=function(e){var t=n[e],a=n[e.replace(u,v)]||!1,i=n[e.replace(u,g)]||!1;return{[C[1].name.saveAs]:t,[C[1].female.saveAs]:a,[C[1].diverse.saveAs]:i}};var n=t._getFormValues(y);for(var a in o)for(var i=Object.keys(o).indexOf(a),s=0;s<o[a].length;s++){o[a][s].candidates=[];o[a][s].name;var r,l,d=parseInt(o[a][s].count),c=o[a][s].joint,f=Object.keys(n),u=C[1].name.name,v=C[1].female.name,g=C[1].diverse.name,p=C[2].yes.name,h=C[2].no.name;if(1===d||!0===c){t.find("["+m+'="'+i+"_"+s+'"]').find("["+_+"]");r=i+"_"+s+"_",l=_filterMatchingIndexes(f,u+r);for(var b=0,S=0;S<l.length;S++)if(_isValidCandidate(l[S])){var E=_getCandidate(l[S]),$=n[l[S].replace(u,p)]||!1,x=n[l[S].replace(u,h)]||!1;void 0===o[a][s].candidates&&(o[a][s].candidates=[]),void 0===o[a][s].candidates[S-b]&&(o[a][s].candidates[S-b]={}),o[a][s].candidates[S-b].candidate=E,$&&(o[a][s].candidates[S-b].yes=$),x&&(o[a][s].candidates[S-b].no=x)}else b++}else for(var w=0;w<d;w++){r=i+"_"+s+"_"+w+"_",l=_filterMatchingIndexes(f,u+r),o[a][s].candidates[w]=[];for(b=0,S=0;S<l.length;S++)if(_isValidCandidate(l[S])){E=_getCandidate(l[S]),$=n[l[S].replace(u,p)]||!1,x=n[l[S].replace(u,h)]||!1;void 0===o[a][s].candidates[w][S-b]&&(o[a][s].candidates[w][S-b]={}),o[a][s].candidates[w][S-b].candidate=E,$&&(o[a][s].candidates[w][S-b].yes=$),x&&(o[a][s].candidates[w][S-b].no=x)}else b++}}},e.fn._getElectionCurrentConfig_2=function(){var t=e(this),n=t._getFormValues(y);for(var a in o)for(var i=Object.keys(o).indexOf(a),s=0;s<o[a].length;s++){o[a][s].name;var r,l,d=parseInt(o[a][s].count),c=o[a][s].joint,f=Object.keys(n),u=C[2].yes.name,v=C[2].no.name;if(1===d||!0===c){t.find("["+m+'="'+i+"_"+s+'"]').find("["+_+"]");r=i+"_"+s+"_",l=_filterMatchingIndexes(f,u+r);for(var g=0;g<l.length;g++){var p=n[l[g]]||0,h=n[l[g].replace(u,v)]||0;o[a][s].candidates[g].yes=p,o[a][s].candidates[g].no=h}}else for(var b=0;b<d;b++){r=i+"_"+s+"_"+b+"_",l=_filterMatchingIndexes(f,u+r);for(g=0;g<l.length;g++){p=n[l[g]]||0,h=n[l[g].replace(u,v)]||0;o[a][s].candidates[b][g].yes=p,o[a][s].candidates[b][g].no=h}}}},_buildStep_3=function(){var e=t.$targetElems.filter(d+3+'"]'),n=t.$targetElems.filter(c+3+'"]'),a=t.$targetElems.filter('[data-tg="election-subitemgroup-template-3"]'),i=t.$targetElems.filter(v+3+'"]');n.empty();for(var r in o){var l=Object.keys(o).indexOf(r),f=r,u=e.clone();u.removeAttr("data-tg style")._replaceTemplatePlaceholders([["title",f],["index",l]]);for(var m=u.find('[data-g-tg="election-subitemgroup-append-3"]'),p=0;p<o[r].length;p++){var h=o[r][p].name,_=a.clone();if(_._replaceTemplatePlaceholders([["index",p],["title",h]]).removeAttr("style data-tg").show(),void 0!==o[r][p].results&&o[r][p].results.length>0)for(var b=_.find(g+3+'"]'),S=0;S<o[r][p].results.length;S++){var C=i.clone(),y=o[r][p].results[S].candidate.name||"";C._replaceTemplatePlaceholders([["candidateName",y]]).removeAttr("style data-tg").show(),C.appendTo(b)}_.appendTo(m)}u.appendTo(n),t.$targetElems.filter(s+3+'"]').show()}},_buildStep_2=function(){var n=t.$functionElems.filter(r+2+'"]'),a=t.$targetElems.filter(d+2+'"]'),i=t.$targetElems.filter(c+2+'"]'),s=t.$targetElems.filter(v+2+'"]');i.empty(),$.$select[2].empty().append(E);for(var l in o)for(var b=Object.keys(o).indexOf(l),S=l,x=0;x<o[l].length;x++){var w,k=o[l][x].name,T=parseInt(o[l][x].count),O=o[l][x].joint,I=o[l][x].candidates;if(_cloneStep_2=function(e){var t=a.clone(),n=e;$.$select[2].append('<option value="'+b+"_"+x+(void 0!==n?"_"+n:"")+'">'+w+"</option>"),t.removeAttr("data-tg style").attr(f,u).attr(m,void 0!==n?b+"_"+x+"_"+n:b+"_"+x)._replaceTemplatePlaceholders([["title",w],["index",b]]);var o;o=void 0!==n&&void 0!==I&&void 0!==I[n]&&I[n].length>0?I[n].length:void 0===n&&void 0!==I&&void 0!==I[0]&&void 0!==I[0].candidate&&I.length>0?I.length:0;for(var r=void 0!==n&&I?I[n]:I,l=t.find(g+2+'"]'),d=0;d<o;d++){var c=s.clone(),v=r[d].candidate.name||"";c._replaceTemplatePlaceholders([["index",o],["candidateName",v]]).removeAttr("style data-tg").attr(p,h).attr(_,d).show()._validateNumberInput();for(var S in C[2]){var E=c.find(C[2][S].selector),k=t.attr(m);E.length>0&&E.attr(y,C[2][S].name+k+"_"+d).attr("value",C[2][S].value)}r&&r[d]&&r[d].candidate&&(void 0!==r[d].yes&&c.find('input[name^="yes"]').val(r[d].yes),void 0!==r[d].no&&c.find('input[name^="no"]').val(r[d].no)),c.appendTo(l)}t.appendTo(i)},1==T)w=S+" » "+k,_cloneStep_2();else if(O)w=S+" » "+k+" (gemeinsam "+T+")",_cloneStep_2();else for(var V=0;V<T;V++)w=S+" » "+k+" » "+(V+1)+"&thinsp;/&thinsp;"+T,_cloneStep_2(V)}n.off("submit.form.2").on("submit.form.2",function(t){t.preventDefault();var n=e(this);n._getElectionCurrentConfig_2(),_getElectionResult()&&_buildStep_3(),n.trigger("built")})},_buildStep_1=function(){var n=t.$functionElems.filter(r+1+'"]'),a=t.$targetElems.filter(d+1+'"]'),i=t.$targetElems.filter(c+1+'"]');t.$targetElems.filter(v+1+'"]');i.empty(),$.$select[1].empty().append(E);for(var s in o)for(var l=Object.keys(o).indexOf(s),g=s,p=0;p<o[s].length;p++){var h,_=o[s][p].name,b=parseInt(o[s][p].count),S=o[s][p].joint,C=o[s][p].candidates;if(_cloneStep_1=function(t){var n=a.clone(),o=t;$.$select[1].append('<option value="'+l+"_"+p+(void 0!==o?"_"+o:"")+'">'+h+"</option>"),n.removeAttr("data-tg style").attr(f,u).attr(m,void 0!==o?l+"_"+p+"_"+o:l+"_"+p)._replaceTemplatePlaceholders([["title",h],["index",l]]);var s;s=void 0!==o&&void 0!==C&&void 0!==C[o]&&C[o].length>0?C[o].length:void 0===o&&void 0!==C&&void 0!==C[0]&&void 0!==C[0].candidate&&C.length>0?C.length:1!=b&&S?b+3:4,n._addSublistItems(s,l,p,o,C),n.find('[data-g-fn="add-subitems"]').on("click",function(t){t.preventDefault();var n=e(this).closest("["+f+'="'+u+'"]'),a=n.find('[data-g-tg="add-subitems-count"]').val();n._addSublistItems(a,l,p,o)}),n.appendTo(i)},1==b)h=g+" » "+_,_cloneStep_1();else if(S)h=g+" » "+_+" (gemeinsam "+b+")",_cloneStep_1();else for(var y=0;y<b;y++)h=g+" » "+_+" » "+(y+1)+"&thinsp;/&thinsp;"+b,_cloneStep_1(y)}n.off("submit.form.1").on("submit.form.1",function(t){t.preventDefault();var n=e(this);n._getElectionCurrentConfig_1(),_buildStep_2(),n.trigger("built")})},_buildStep_0=function(){var i=t.$functionElems.filter(r+0+'"]'),s=t.$targetElems.filter(d+0+'"]'),l=t.$targetElems.filter(c+0+'"]'),p=t.$targetElems.filter(v+0+'"]');l.empty();for(var h in a){var _=Object.keys(a).indexOf(h),b=s.clone();b.removeAttr("data-tg style").attr(f,u).attr(m,_)._replaceTemplatePlaceholders([["title",h],["index",_]]);for(var E in S[0]){(T=b.find(S[0][E].selector)).length>0&&(T.attr(y,S[0][E].name+_).attr("value",S[0][E].value),void 0!==n&&n[h]&&T.attr("checked",""))}for(var $=b.find(g+0+'"]'),x=0;x<a[h].length;x++){var w=x,k=p.clone();a[h][x].countVariable?void 0!==o[h]&&void 0!==o[h][x]&&!o[h][x].count>1&&k.find('[data-tp-o="3"]').hide():Number.isInteger(a[h][x].count)&&a[h][x].count>1||k.find('[data-tp-o="3"]').remove(),a[h][x].countVariable?k.find('[data-tp-o="1"]').remove():k.find('[data-tp-o="2"]').remove(),k.removeAttr("data-tg style")._replaceTemplatePlaceholders([["electionItemType",a[h][x].name],["electionItemCount",a[h][x].count],["itemIndex",_],["index",w]])._validateNumberInput();for(var E in C[0]){var T;(T=k.find(C[0][E].selector)).length>0&&(T.attr(y,C[0][E].name+_+"_"+w).attr("value",C[0][E].value),T.is('[name^="count"]')&&o[h]&&o[h][x]&&!0===o[h][x].countVariable&&o[h][x].count>0&&T.attr("value",o[h][x].count),T.is('[type="checkbox"]')&&o[h]&&o[h][x]&&o[h][x].joint===JSON.parse(C[0].joint.value)&&T.attr("checked",""))}k.appendTo($)}b.appendTo(l).checkSlideToggle({triggerSelector:'[data-g-fn="accordion-trigger"]'})}i.off("submit.form.0").on("submit.form.0",function(t){t.preventDefault();var n=e(this);n._getElectionCurrentConfig_0(),_buildStep_1(),n.trigger("built")})};var $={currentStep:0,previousStep:null,currentItemCoordinates:null,steps:3,$electionStep:[],$stepPrev:[],$stepNext:[],$select:[],selectValues:[],currentSelectValue:[],electionDoneSelectValue:null};$._getSelectValues=function(t){var n=[];return e(t).find("option").each(function(){n.push(e(this).val())}),n},$._setItem=function(e,t){var n=void 0===t?$.currentStep:t;console.log("_Nav._setItem (step: "+n+") to: "+e),$.$select[n].val(e).trigger("change")},$._gotoStep=function(e,n){$.previousStep=$.currentStep,$.currentStep=e,console.log("GOTO: "+$.currentStep+" FROM: "+$.previousStep);for(var a=0;a<$.steps;a++)a!==$.currentStep?$.$electionStep[a].hide():$.$electionStep[a].show();if(0!=$.selectValues.length||1!=$.currentStep&&2!=$.currentStep||($.selectValues=$._getSelectValues($.$select[$.currentStep])),2==$.currentStep){if(_checkForCandidates=function(e){var t=e.split("_");return _checkElectionConfigCandidatesOrVotes(t[0],t[1],t[2])[0]},_showMissingCandidatesDialog=function(){t.$targetElems.filter('[data-tg="confirm-modal"]')._confirmModal({header:"Hinweis",headerClass:"modal-title",body:"Bitte Kandidaten hinzufügen.",confirmButtonHide:!0,dismissButtonClass:"btn btn-primary",dismissButtonIconClass:"fa fa-check",dismissButtonText:"Ok"})},_increaseSelectValue=function(e){$.currentSelectValue[$.currentStep]=e,console.log("_increaseSelectValue: "+e),_checkForCandidates(e)?(console.log("valid"),$._setItem(e)):(console.log("candidates missing, go back"),_showMissingCandidatesDialog(),$._gotoStep($.currentStep-1,e))},console.log("CHECK IF SET SELECT"),$.previousStep!=$.currentStep)if(console.log($.previousStep+" != "+$.currentStep),$.currentSelectValue[$.currentStep]){i=$.currentSelectValue[$.currentStep];$._setItem(i),_checkForCandidates(i)||(console.log("candidates missing, go back"),_showMissingCandidatesDialog(),$._gotoStep($.currentStep-1,i))}else{console.log("increase & check");var i=$.selectValues[$.selectValues.indexOf("-1")+1];_increaseSelectValue(i)}if($.previousStep==$.currentStep)if(console.log($.previousStep+" == "+$.currentStep),$.electionDoneSelectValue=$.currentSelectValue[$.currentStep],$.selectValues.indexOf($.currentSelectValue[$.currentStep])+1<$.selectValues.length){console.log("increase & check");i=$.selectValues[$.selectValues.indexOf($.currentSelectValue[$.currentStep])+1];_increaseSelectValue(i)}else{t.$targetElems.filter('[data-tg="confirm-modal"]')._confirmModal({header:"Fertig",headerClass:"modal-title text-success",body:"<p>Es wurden alle Wahlgänge durchgeführt.<p><p>Falls irgendwo Korrekturen nötig sein sollten, einfach zurück gehen, korrigieren und Wahlen fortsetzen bis zu dieser Meldung.</p>",confirmButtonHide:!0,dismissButtonClass:"btn btn-success",dismissButtonIconClass:"fa fa-check",dismissButtonText:"Ok"})}}$._toTop(),void 0!==n&&void 0!==$.$select[$.currentStep]&&$.selectValues.indexOf(n)>=0&&$._setItem(n),console.log("nav goto "+$.currentStep)},$._prev=function(e){var t=$.currentStep>0?$.currentStep-1:0;$._gotoStep(t,e),$._toTop(),console.log("nav prev "+$.currentStep)},$._next=function(e){var t=$.currentStep<$.steps-1?$.currentStep+1:$.steps-1;$._gotoStep(t,e),$._toTop(),console.log("nav next "+$.currentStep)},$._toTop=function(){t.$functionElems.filter('[data-fn="to-top-wrapper"]').children("a").trigger("click")},$._init=function(){for(var n=0;n<$.steps;n++)$.$electionStep[n]=t.$targetElems.filter(s+n+'"]'),n>0&&($.$stepPrev[n]=t.$functionElems.filter('[data-fn="election-back-'+n+'"]'),$.$stepPrev[n].on("click",function(e){e.preventDefault(),$._prev()})),n<$.steps&&($.$stepNext[n]=t.$functionElems.filter(r+n+'"]'),$.$stepNext[n].on("built",function(){$._next()})),n>0&&t.$functionElems.filter(l+n+'"]').length>0&&($.$select[n]=t.$functionElems.filter(l+n+'"]'),$.currentSelectValue[n]=$.$select[n].val(),console.log("_Nav.currentSelectValue[ i ]: "+$.currentSelectValue[n]),$.$select[n].on("change",function(){var a=e(this).val(),i=e(this).closest("form"),o=i.find(t.$targetElems.filter('[data-tg="hide-last-item"]'));$.currentSelectValue[n]=a,$.currentItemCoordinates=a.split("_"),console.log("doing select change to: "+a+" – _Nav.currentSelectValue[ "+$.currentStep+" ]: "+$.currentSelectValue[$.currentStep]+" – _Nav.currentItemCoordinates: "+$.currentItemCoordinates[0]+" "+$.currentItemCoordinates[1]+" "+$.currentItemCoordinates[2]),-1!=a?(i.find("["+m+"]").hide(),i.find("["+m+'^="'+a+'"]').show(),a!=$.selectValues[$.selectValues.length-1]?o.show():o.hide()):($.currentItemCoordinates=null,i.find("["+m+"]").show(),o.hide())})),1==n&&t.$functionElems.filter('[data-fn="election-next-item"]')&&($nextItemButton=t.$functionElems.filter('[data-fn="election-next-item"]'),$nextItemButton.on("click",function(e){e.preventDefault();var t=$.$select[$.currentStep].val(),a=$.selectValues[$.selectValues.indexOf(t)+1];$.$select[$.currentStep].val(a).trigger("change"),$.currentSelectValue[n]=a,$.currentItemCoordinates=a.split("_"),$._toTop()}));$._gotoStep($.currentStep)},$._reset=function(){$.currentStep=0,$.previousStep=null,$.selectValues=[],$.currentSelectValue=[],$.electionDoneSelectValue=null,$._gotoStep($.currentStep)},_saveCurrentElectionConfig=function(){console.log("save step: "+$.currentStep);var n=$.currentStep<$.steps-1?$.currentStep:$.steps-2;if(t.$functionElems.filter(r+n+'"]')["_getElectionCurrentConfig_"+n](),void 0!==o){var a=t.$targetElems.filter('[data-tg="save-modal"]'),i=a.find('input[name="file_name"]'),s=a.filter(t.$functionElems.find('[data-fn="save-modal-confirm"]')),l=new Date,d=[l.getFullYear(),("00"+(l.getMonth()+1)).slice(-2),("00"+l.getDate()).slice(-2)].join("-")+"_"+[("00"+l.getHours()).slice(-2),("00"+l.getMinutes()).slice(-2),("00"+l.getSeconds()).slice(-2)].join("-");i.val("dib_wahl-checker_"+d).on("focus",function(){e(this).select()}),e.fn._addDownload=function(t){var n=e(this),a=JSON.stringify(o),s=new Blob([a],{type:"application/json"});n.attr("href",URL.createObjectURL(s)).attr("download",i.val()+".json")},a.on("shown.bs.modal",(i=e(i),(s=t.$functionElems.filter('[data-fn="save-modal-confirm"]'))._addDownload(),i.on("change",function(){s._addDownload()}),void setTimeout(function(){i.focus()},550))),s.on("click",function(){t.$targetElems.filter('[data-tg="save-modal"]').modal("hide")}),a.modal("show")}},t.$functionElems.filter('[data-fn="config-download"]').on("click",function(){t.$functionElems.filter("#toggle-navbar-collapse").trigger("click"),_saveCurrentElectionConfig()}),_loadCurrentElectionConfig=function(){var a,i=t.$targetElems.filter('[data-tg="load-modal"]'),r=i.find("form"),l=r.find('input[name="file_name"]');i.modal("show"),l.on("change",function(e){var t=e.target.files;if(t&&t.length>0){var n=new FileReader;n.onload=(t[0],function(e){try{a=JSON.parse(e.target.result)}catch(e){console.log("error trying to parse json: "+e)}}),n.readAsText(t[0])}}),r.one("submit",function(i){i.preventDefault(),void 0!==a&&(n=e.extend({},a),o=e.extend({},a),t.$targetElems.filter('[data-tg="load-modal"]').modal("hide"),_buildStep_0(),$._reset(),t.$targetElems.filter(s+3+'"]').hide(),l.val(""))})},t.$functionElems.filter('[data-fn="config-load"]').on("click",function(){t.$functionElems.filter("#toggle-navbar-collapse").trigger("click"),_loadCurrentElectionConfig()}),_resetElection=function(){},e.fn._confirmModal=function(t){t=e.extend({},{header:"Bitte bestätigen",headerClass:"modal-title",body:"Bitte bestätige die Aktion.",dismissButtonHide:!1,confirmButtonHide:!1,dismissButtonClass:"btn btn-default",confirmButtonClass:"btn btn-danger",dismissButtonIconClass:"fa fa-close",confirmButtonIconClass:"fa fa-check",dismissButtonText:"Abbrechen",confirmButtonText:"Ok",confirmCallback:null,dismissCallback:null},t);var n=e(this);n.find('[data-g-tg="modal-title"]').html(t.header).attr("class",t.headerClass),n.find('[data-g-tg="modal-body"]').html(t.body);var a=n.find('[data-g-fn="confirm-modal-confirm"]');t.confirmButtonHide?a.hide():(a.attr("class",t.confirmButtonClass).show(),a.find('[data-g-tg="btn-icon"]').attr("class",t.confirmButtonIconClass),a.find('[data-g-tg="btn-text"]').html(t.confirmButtonText));var i=n.find('[data-g-fn="confirm-modal-dismiss"]');t.dismissButtonHide?i.hide():(i.attr("class",t.dismissButtonClass).show(),i.find('[data-g-tg="btn-icon"]').attr("class",t.dismissButtonIconClass),i.find('[data-g-tg="btn-text"]').html(t.dismissButtonText)),n.modal("show"),t.confirmCallback&&a.one("click",function(){t.confirmCallback()}),t.dismissCallback&&n.one("hide.bs.modal",function(){t.dismissCallback()})},t.$functionElems.filter('[data-fn="config-delete"]').on("click",function(){t.$functionElems.filter("#toggle-navbar-collapse").trigger("click");t.$targetElems.filter('[data-tg="confirm-modal"]')._confirmModal({header:"Löschen bestätigen",headerClass:"modal-title text-danger",body:"Möchtest Du wirklich die gesamte Wahl zurücksetzen?",dismissButtonClass:"btn btn-default",confirmButtonClass:"btn btn-danger",dismissButtonIconClass:"fa fa-close",confirmButtonIconClass:"fa fa-trash",dismissButtonText:"Nein, doch nicht",confirmButtonText:"Zurücksetzen",confirmCallback:function(){window.location.reload()}})}),e.fn.dibElection=function(){_buildStep_0(),$._init()}}(jQuery,MY_UTILS),function(e,t){e.fn.dropdownMultilevel=function(n){function a(){for(var t=s.length-1;t>=0;t--)e(s[t])._closeDropdown()}function i(o){t.$body.one("click.body",function(t){var r=e(t.target);if(o.length>0)if(-1==e.inArray(r[0],l)){var d=e(o[o.length-1])._getList();d.children().children(n.closeElemSelector).parent().has(r).length>0?(t.preventDefault(),e(o[o.length-1])._closeDropdown(),i(s)):d.has(r).length>0||d.is(r)?i(s):!d.has(r).length>0&&a()}else i(s)})}var o={openedClass:t.classes.open,hasOpenedSublevelClass:"has-"+t.classes.open,animatingClass:t.classes.animating,closeElemSelector:'[data-fn="dropdown-multilevel-close"]',excludedBodyElements:'[data-tg="dropdown-multilevel-excluded"]',scrollDuration:100};n=e.extend({},o,n);var s=[],r=e(this),l=t.$targetElems.filter(n.excludedBodyElements);e.fn._getTarget=function(){var n,a=e(this);if(a.attr(t.attributes.target)){var i=a.attr(t.attributes.target);n=t.$targetElems.filter(i).lenght>0?t.$targetElems.filter(i):e(i)}else n=a.parent("li");return n},e.fn._getList=function(){var t=e(this);return t._getTarget().find('[aria-labelledby="'+t.attr("id")+'"]')},e.fn._getCloseElem=function(){return e(this)._getList().children().fist().find('[data-fn="dropdown-multilevel-close"]')},e.fn._getParentList=function(){return e(this)._getTarget().parent("ul")},e.fn._openDropdown=function(){var t=e(this),a=t._getTarget(),i=t._getParentList();a.addClass(n.openedClass).setRemoveAnimationClass(n.animatingClass),t.ariaExpanded("true"),i.animate({scrollTop:0},n.scrollDuration,function(){e(this).addClass(n.hasOpenedSublevelClass)}),s.push(t)},e.fn._closeDropdown=function(){var t=e(this),a=t._getTarget(),i=t._getParentList();a.removeClass(n.openedClass).setRemoveAnimationClass(n.animatingClass),t.ariaExpanded("false"),i.removeClass(n.hasOpenedSublevelClass),s.pop()},r.each(function(){var n=e(this),o=(n.attr(t.attributes.target),n._getTarget()),r=n._getList();n.on("click",function(l){if(o.length>0&&r.length>0){t.$body.off("click.body");var d=e(l.target),c=e(s[s.length-1]);if(c.has(d).length>0||c.is(d))l.preventDefault(),e(s[s.length-1])._closeDropdown(),s.length>0&&i(s);else if(r.is(":visible")&&r.elemPositionedInside(o.parent()))i(s);else{if(l.preventDefault(),s.length>0){!e(s[s.length-1])._getList().has(n).length>0&&a()}n._openDropdown();var f;(f=n.getOptionsFromAttr())&&f.focusOnOpen&&t.$targetElems.filter(f.focusOnOpen).focus(),l.stopPropagation(),i(s)}}})}),t.$window.on("orientationchange sizeChange",function(){a()})}}(jQuery,MY_UTILS),function(e,t){e.fn.remoteEvent=function(){e(this).each(function(){var n=e(this),a=n.attr(t.attributes.target)||"",i=t.$targetElems.filter(a).lenght>0?t.$targetElems.filter(a):e(a),o=n.getOptionsFromAttr(),s=o.triggerEvent||"click",r=o.remoteEvent||"click";n.on(s,function(){i.length>0&&i.trigger(r)})})}}(jQuery,MY_UTILS),function(e,t){e.fn.toggleToTopButton=function(n){function a(){t.$document.scrollTop()>100?$elem.is("."+n.visibleClass)||$elem.addClass(n.visibleClass):$elem.is("."+n.visibleClass)&&$elem.removeClass(n.visibleClass)}$elem=e(this);var i={threshold:100,visibleClass:t.classes.open};n=e.extend({},i,n),a(),t.$window.on("scroll resize",function(){a()})}}(jQuery,MY_UTILS),function(e,t){e.fn.toggle=function(){e(this).each(function(){var n=e(this),a=n.attr(t.attributes.target)||"",i=t.$targetElems.filter(a).lenght>0?t.$targetElems.filter(a):e(a),o=t.classes.open,s=t.classes.animating;i.getTransitionDuration();n.on("click",function(){i.length>0&&(i.is("."+o)?(i.removeClass(o),n.ariaExpanded("false")):(i.addClass(o),n.ariaExpanded("true")),i.setRemoveAnimationClass(s))})})}}(jQuery,MY_UTILS),function(e,t){t.$functionElems.filter('[data-fn="toggle"]').toggle(),t.$functionElems.filter('[data-fn="dropdown-multilevel"]').dropdownMultilevel(),t.$functionElems.filter('[data-fn="remote-event"]').remoteEvent(),e('a[href^="#"]:not([href="#"])').animatedAnchors({offset:function(){return t.anchorOffsetTop}}),t.$functionElems.filter('[data-fn="to-top-wrapper"]').toggleToTopButton(),t.$functionElems.filter('[data-fn="dib-election-tool"]').dibElection()}(jQuery,MY_UTILS);